import streamlit as st
st.set_page_config(layout="wide")
st.title("电脑性能与二手硬件杂谈")
st.subheader("1.本代游戏环境：钉子户与渣优化齐聚", divider=True)
st.write("我第一台电脑也就是现在用的电脑GPU为RTX3070m，CPU为5600h，屏幕用了2.5k 165hz的。虽然时间上是本世代，但我也玩过不少上世代的游戏。我选择游戏时，画质是重要的考虑因素。刺客信条：奥德赛、泰坦陨落2、极限竞速：地平线4这个级别的游戏全高画质能达到45帧以上，在2.5k屏幕上也达到了比较好的画质表现。")
st.write("本世代初期比较优秀的游戏，例如极限竞速：地平线5、光环：无限、超级房车赛：传奇、F1 2021和影子武士3，由于制作基准提高，比上世代后期的游戏光照更为真实，而性能要求基本一致。")
st.write("不少更晚的游戏优化表现差不少，主要原因是滥用全局光照和Nanite等技术，这些技术虽然方便开发，但画质相比本世代初期几款优秀游戏没有优势，性能表现反而差很多。即使是黑神话：悟空和最终幻想16等没有优化问题的游戏也要开帧生成才能达到接近的帧率。")
st.write("使用全局动态光照技术在开发难度和昼夜切换等功能上还是有一定优势，也允许中等规模的工作室做出画质表现较好的游戏，例如瘟疫传说：安魂曲和无限暖暖。加上帧生成的话，3070m这个级别也能作为钉子户。以下是使用黑神话：悟空测试工具的运行结果。")
st.image("files/wukong.jpg")
st.subheader("2.DCC软件：性能需求上限高", divider=True)
st.write("虽然本世代游戏解析度到达上限，但这主要受到本世代开发基准限制，在DCC软件中可以使用更高面数。游戏中同时加载的面数较多的有数百万面，而在DCC软件中由于可以使用更高精度的模型，我制作的场景一般在一千到三千万面，在电影制作中一个模型能达到数亿面。加载更多面的显存要求和渲染的算力消耗会提高。我在虚幻5使用Megascans资源制作了一些场景，实时运行帧率约为7帧，如果使用高端卡能流畅运行，但高端电脑也可以制作更大的场景以及提高模型精度。")
st.subheader("3.二手GPU：矿卡崛起、计算卡衰落", divider=True)
st.write("二手硬件市场是长期存在的，我在接触“垃圾佬”文化后，更偏向性价比有明显优势的硬件。")
st.write("曾经有性价比优势的二手GPU是英伟达Tesla系列的计算卡。当时AI绘画模型开始流行而显存优化措施较少，就有不少人入手显存大的Tesla m40等计算卡。由于热度上升使这部分计算卡价格上升，并且这部分计算卡对低精度计算支持较差，性价比优势逐渐消失。")
st.write("随着矿潮结束，大量矿卡流入二手市场，部分加密货币也禁止GPU挖矿,也带来了一些性价比优势明显的GPU，比较有代表性的有RX580、P106和40hx等型号，虽然矿卡可靠性较差，但在低端DIY电脑中比较有优势。其它GPU受二手市场和AI热度的影响，特别是大显存和低精度算力高的适合AI应用的GPU性价比优势不大。")
st.subheader("4.二手CPU：从E5 v3到EPYC二代", divider=True)
st.write("相比二手GPU，二手服务器CPU容易获得性价比优势，这是因为偏向多核性能的CPU不适合常规桌面应用和游戏以及受AI影响较小。")
st.write("二手CPU中最热门的是英特尔至强E5 v3系列，双路多核性能上限大致相当于AMD 5950x或英特尔12900k，第三方的主板和散热器等配件也比较完善。相比E5 v4系列，由于兼容ddr3内存，能降低内存成本。相比消费级处理器，有更多的内存通道（双路共8通道）和Pcie通道，扩展内存和存储空间比较方便，也可以提高内存和硬盘的总速度。以下是官网上该系列的所有CPU，可以根据内核数和频率推测实际性能")
st.image("files/e5v3.jpeg")
st.write("如果对性能和内存带宽要求更高甚至代替GPU用于AI应用，AMD EPYC二代是比较好的选择，虽然受缺少第三方主板、无锁CPU较少等问题影响，组双路最低也要接近主流配置电脑的价格，但在对CPU性能要求较高的应用中有优势，双路能达到400g带宽。在AI应用中对比GPU，其中性能最高的方案是使用双路共128核的7742，性能相当于RTX3090。接近主流价位的方案有双路共64核的7502（性能相当于2070Super）以及双路96核但内存带宽少25%的7k62（性能相当于2080ti）。以下是官网上该系列所有CPU（7k62是厂商特供型号，不在官方列表）")
st.image("files/epyc7002.jpeg")
st.write("对于性能要求不高的使用场景，二手CPU也有其它方案。希望用低成本运行主流桌面程序特别是需要核显时可以选至强E3 v3系列，性能略高于第九代酷睿i3。用于低功耗场景可以考虑瘦客户机。我入手了一台瘦客户机作为Linux物理机，在前面的Linux部分有详细说明。")
st.subheader("5.关于低功耗处理器", divider=True)
st.write("低功耗处理器分为多个系列，英特尔有几个功耗10w左右的系列，其中凌动X系列偏向工业，支持时间较长，其它则偏向消费级；n系列推出较晚，为大小核架构中的全小核处理器，存在核间延时等问题；赛扬j系列已停产，可能由n系列替代。使用这一级别处理器的产品包括瘦客户机、x86平板电脑和电脑棒等，有不少成品二手硬件可选。另外也有与标压处理器同核心的低压版本，包括英特尔p系列以及AMD的u版本，功耗15到28w。")
st.write("如果用于笔记本电脑，使用TDP在28到45w的移动端标压处理器可以做到比较好的散热和续航表现，但用于掌机的话还是需要低压处理器才能在控制重量的情况下达到较好的续航（参考AYANEO AIR Plus，使用6英寸屏幕、46.2Wh电池，重量525g，价格也是Windows掌机中少有的不明显高于同配置笔记本电脑的。貌似也没有其它Windows掌机使用15w的处理器。）。")
st.write("如果要在前文的标准下达到1080p钉子户水平，大约需要780m的2倍性能。根据报道，AMD的Strix Halo能满足这一要求，并且增加到4个内存通道。不过由于规模提升，预计低压版本功率也会达到45w或更高，用于笔记本电脑尚可，用于掌机的续航表现会比较差，价格也偏高。")
st.subheader("6.关于普通桌面应用的性能要求", divider=True)
st.write("这里的普通桌面应用指对性能要求不高且一般用户有机会接触的使用场景，现在这类应用相比早期桌面应用的性能要求高很多。早期性能要求提升主要是因为功能扩展，后来功能基本达到上限；在互联网时代不少企业使用web技术简化开发，性能要求也有一定提升，但一般来说电脑2代i7/j4105以上、手机骁龙845以上（流畅度要求高的话可以选性能高一些的）就够用了。")
st.write("受这一情况以及经济等问题影响，近几年一般用户更换手机/电脑的频率下降了，对此有的硬件不断寻找新的卖点进行营销，有的硬件就缺少高性价比产品了。但随着AI应用的发展，芯片需求应该会长期存在。")
st.subheader("7.几种ARM处理器", divider=True)
st.write("除部分性能占用较大的程序以及闭源程序外，大部分程序兼容ARM架构，其它不少程序可以转译运行。常见的ARM处理器中，全志H618性能大致相当于J1800，瑞芯微RK3576性能大致相当于J4125且视频编解码和AI性能有优势。考虑价格因素，在应用比较确定且扩展性要求不高的环境中或者便携度要求较高都可以优先选择ARM处理器。")
st.write("一些骁龙处理器具有Windows支持，主要包括骁龙845、855和8 Elite。有时候用于低功耗设备，但由于价格优势不大且兼容性有缺陷，相应设备用户较少。")
